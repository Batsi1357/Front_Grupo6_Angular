<div class="container-clientes">
  <div class="header-with-back">
    <button class="btn-volver" (click)="volverAlHome()" title="Volver al Home">
      â¬…ï¸ Volver al Home
    </button>
    <h1>Consultas de Clientes</h1>
  </div>
  <p class="subtitulo">4 Queries Diferentes - Cliente Entity</p>

  <!-- Panel de BÃºsquedas -->
  <div class="panel-busquedas">

    <!-- Query 1: Buscar por Email Exacto (Query Method) -->
    <div class="query-card">
      <div class="query-header">
        <span class="query-badge query-method">Query Method</span>
        <h3>Buscar por Email Exacto</h3>
      </div>
      <div class="query-body">
        <input
          type="email"
          [(ngModel)]="busquedaEmail"
          placeholder="Ej: juan@gmail.com"
          class="input-busqueda"
          (keyup.enter)="buscarPorEmail()">
        <button (click)="buscarPorEmail()" class="btn-buscar" [disabled]="cargando">
          ğŸ” Buscar
        </button>
      </div>
    </div>

    <!-- Query 2: Buscar por Dominio de Email (SQL Nativo) -->
    <div class="query-card">
      <div class="query-header">
        <span class="query-badge sql-nativo">SQL Nativo</span>
        <h3>Buscar por Dominio de Email</h3>
      </div>
      <div class="query-body">
        <input
          type="text"
          [(ngModel)]="busquedaDominio"
          placeholder="Ej: @gmail.com o gmail.com"
          class="input-busqueda"
          (keyup.enter)="buscarPorDominio()">
        <button (click)="buscarPorDominio()" class="btn-buscar" [disabled]="cargando">
          ğŸ” Buscar
        </button>
      </div>
    </div>

    <!-- Query 3: Buscar por Edad MÃ­nima (JPQL) -->
    <div class="query-card">
      <div class="query-header">
        <span class="query-badge jpql">JPQL</span>
        <h3>Buscar por Edad MÃ­nima</h3>
      </div>
      <div class="query-body">
        <input
          type="number"
          [(ngModel)]="busquedaEdad"
          placeholder="Ej: 18"
          class="input-busqueda"
          min="0"
          (keyup.enter)="buscarPorEdad()">
        <button (click)="buscarPorEdad()" class="btn-buscar" [disabled]="cargando">
          ğŸ” Buscar
        </button>
      </div>
    </div>

    <!-- Query 4: Buscar por Nombre o Apellido (JPQL) -->
    <div class="query-card">
      <div class="query-header">
        <span class="query-badge jpql">JPQL</span>
        <h3>Buscar por Nombre o Apellido</h3>
      </div>
      <div class="query-body">
        <input
          type="text"
          [(ngModel)]="busquedaTexto"
          placeholder="Ej: Juan o PÃ©rez"
          class="input-busqueda"
          (keyup.enter)="buscarPorTexto()">
        <button (click)="buscarPorTexto()" class="btn-buscar" [disabled]="cargando">
          ğŸ” Buscar
        </button>
      </div>
    </div>

  </div>

  <!-- Botones de Control -->
  <div class="controles">
    <button (click)="cargarTodos()" class="btn-todos" [disabled]="cargando">
      ğŸ“‹ Ver Todos
    </button>
    <button (click)="limpiarBusqueda()" class="btn-limpiar" [disabled]="cargando">
      ğŸ”„ Limpiar
    </button>
  </div>

  <!-- Mensaje de Estado -->
  <div class="mensaje-estado" *ngIf="mensaje">
    <span [class.cargando]="cargando">{{ mensaje }}</span>
  </div>

  <!-- Tabla de Resultados -->
  <div class="tabla-container">
    <table class="tabla-clientes" *ngIf="clientesFiltrados.length > 0">
      <thead>
        <tr>
          <th>ID</th>
          <th>Email</th>
          <th>Edad</th>
          <th>Nombre</th>
          <th>Apellido</th>
          <th>Celular</th>
          <th>DirecciÃ³n</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let cliente of clientesFiltrados" class="fila-cliente">
          <td [class.celda-llena]="cliente.idCliente" [class.celda-vacia]="!cliente.idCliente">{{ cliente.idCliente || '-' }}</td>
          <td [class.celda-llena]="cliente.email" [class.celda-vacia]="!cliente.email">{{ cliente.email || '-' }}</td>
          <td [class.celda-llena]="cliente.edad" [class.celda-vacia]="!cliente.edad">{{ cliente.edad || '-' }}</td>
          <td [class.celda-llena]="cliente.Nombre" [class.celda-vacia]="!cliente.Nombre">{{ cliente.Nombre || '-' }}</td>
          <td [class.celda-llena]="cliente.Apellido" [class.celda-vacia]="!cliente.Apellido">{{ cliente.Apellido || '-' }}</td>
          <td [class.celda-llena]="cliente.Celular" [class.celda-vacia]="!cliente.Celular">{{ cliente.Celular || '-' }}</td>
          <td [class.celda-llena]="cliente.Direccion" [class.celda-vacia]="!cliente.Direccion">{{ cliente.Direccion || '-' }}</td>
        </tr>
      </tbody>
    </table>

    <div class="info-box" *ngIf="clientesFiltrados.length > 0">
      <p><strong>Nota:</strong> Los campos Nombre, Apellido, Celular y DirecciÃ³n no estÃ¡n siendo devueltos por el backend. 
      Contacta al administrador del servidor para que incluya estos campos en la respuesta del endpoint <code>/Cliente</code>.</p>
    </div>

    <div class="no-resultados" *ngIf="clientesFiltrados.length === 0 && !cargando">
      <p>âŒ No se encontraron clientes con los criterios de bÃºsqueda</p>
    </div>

    <div class="loader" *ngIf="cargando">
      <p>â³ Cargando...</p>
    </div>
  </div>
</div>
